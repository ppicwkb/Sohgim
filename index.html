<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InventoryPro - Advanced Warehouse Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* Professional Corporate Design System */
        :root {
            /* Primary Brand Colors */
            --primary-50: #eff6ff;
            --primary-100: #dbeafe;
            --primary-200: #bfdbfe;
            --primary-300: #93c5fd;
            --primary-400: #60a5fa;
            --primary-500: #3b82f6;
            --primary-600: #2563eb;
            --primary-700: #1d4ed8;
            --primary-800: #1e40af;
            --primary-900: #1e3a8a;
            
            /* Neutral Corporate Palette */
            --neutral-50: #f8fafc;
            --neutral-100: #f1f5f9;
            --neutral-200: #e2e8f0;
            --neutral-300: #cbd5e1;
            --neutral-400: #94a3b8;
            --neutral-500: #64748b;
            --neutral-600: #475569;
            --neutral-700: #334155;
            --neutral-800: #1e293b;
            --neutral-900: #0f172a;
            
            /* Status Colors */
            --success-50: #f0fdf4;
            --success-500: #22c55e;
            --success-600: #16a34a;
            --warning-50: #fffbeb;
            --warning-500: #f59e0b;
            --warning-600: #d97706;
            --danger-50: #fef2f2;
            --danger-500: #ef4444;
            --danger-600: #dc2626;
            
            /* Typography Scale */
            --font-family-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --font-family-mono: 'JetBrains Mono', 'Fira Code', Consolas, monospace;
            
            /* Spacing Scale */
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            
            /* Border Radius */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            
            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        /* Global Typography */
        * {
            font-family: var(--font-family-primary);
        }
        
        /* Professional Status Indicators */
        .status-critical { 
            background: linear-gradient(135deg, var(--danger-50) 0%, #fecaca 100%) !important; 
            border-left: 4px solid var(--danger-500) !important;
            position: relative;
        }
        .status-critical::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 0 20px 20px 0;
            border-color: transparent var(--danger-500) transparent transparent;
        }
        
        .status-warning { 
            background: linear-gradient(135deg, var(--warning-50) 0%, #fef3c7 100%) !important; 
            border-left: 4px solid var(--warning-500) !important;
        }
        
        .status-normal {
            background: linear-gradient(135deg, var(--success-50) 0%, #dcfce7 100%) !important;
            border-left: 4px solid var(--success-500) !important;
        }
        
        /* Professional Table Headers */
        .table-header {
            background: linear-gradient(135deg, var(--neutral-50) 0%, var(--neutral-100) 100%);
            border-bottom: 2px solid var(--neutral-200);
        }
        
        .sortable { 
            cursor: pointer; 
            user-select: none; 
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            font-weight: 600;
            color: var(--neutral-700);
            letter-spacing: 0.025em;
        }
        .sortable:hover { 
            background: linear-gradient(135deg, var(--primary-50) 0%, var(--primary-100) 100%);
            color: var(--primary-700);
        }
        .sort-asc::after { 
            content: ' ▲'; 
            color: var(--primary-600);
            font-size: 0.75rem;
            margin-left: 0.25rem;
        }
        .sort-desc::after { 
            content: ' ▼'; 
            color: var(--primary-600);
            font-size: 0.75rem;
            margin-left: 0.25rem;
        }
        
        /* Professional Executive Dashboard Cards */
        .executive-card {
            background: linear-gradient(135deg, var(--card-primary) 0%, var(--card-secondary) 100%);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.15);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.1),
                0 8px 16px rgba(0, 0, 0, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(20px);
        }
        
        .executive-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(255,255,255,0.25) 0%, 
                transparent 30%, 
                rgba(0,0,0,0.05) 70%, 
                rgba(0,0,0,0.15) 100%);
            pointer-events: none;
            z-index: 1;
        }
        
        .executive-card::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, 
                rgba(255,255,255,0.4) 0%, 
                transparent 25%, 
                transparent 75%, 
                rgba(255,255,255,0.4) 100%);
            border-radius: inherit;
            opacity: 0;
            transition: opacity 0.4s ease;
            pointer-events: none;
            z-index: 0;
        }
        
        .executive-card:hover::after {
            opacity: 1;
        }
        
        .executive-card:hover {
            transform: translateY(-12px) scale(1.03);
            box-shadow: 
                0 32px 64px rgba(0, 0, 0, 0.2),
                0 16px 32px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.3);
        }
        
        /* Enhanced Card Icon Styling */
        .card-icon-container {
            position: relative;
            z-index: 2;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        
        .executive-card:hover .card-icon-container {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }
        
        /* Enhanced Card Content */
        .card-content {
            position: relative;
            z-index: 2;
        }
        
        .card-title-enhanced {
            color: rgba(255, 255, 255, 0.95);
            font-size: 11px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 12px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .card-title-enhanced::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 0;
            width: 24px;
            height: 2px;
            background: rgba(255, 255, 255, 0.4);
            border-radius: 1px;
        }
        
        .card-value-enhanced {
            color: white;
            font-size: 36px;
            font-weight: 900;
            line-height: 1;
            margin-bottom: 8px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            letter-spacing: -0.02em;
        }
        
        .card-unit-enhanced {
            color: rgba(255, 255, 255, 0.8);
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .card-status-dot {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.9);
            animation: pulse-enhanced 2s infinite;
            z-index: 3;
            box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7);
        }
        
        @keyframes pulse-enhanced {
            0% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7);
            }
            70% {
                transform: scale(1);
                box-shadow: 0 0 0 8px rgba(255, 255, 255, 0);
            }
            100% {
                transform: scale(0.95);
                box-shadow: 0 0 0 0 rgba(255, 255, 255, 0);
            }
        }
        
        .card-metric-info {
            display: flex;
            align-items: center;
            margin-top: 16px;
            padding-top: 12px;
            border-top: 1px solid rgba(255, 255, 255, 0.15);
            color: rgba(255, 255, 255, 0.85);
            font-size: 11px;
            font-weight: 500;
            z-index: 2;
            position: relative;
        }
        
        .card-metric-info svg {
            width: 12px;
            height: 12px;
            margin-right: 6px;
            opacity: 0.8;
        }
        
        /* Professional Card Variants with Enhanced Gradients */
        .card-primary { 
            --card-primary: #4f46e5; 
            --card-secondary: #7c3aed; 
        }
        .card-success { 
            --card-primary: #059669; 
            --card-secondary: #10b981; 
        }
        .card-warning { 
            --card-primary: #d97706; 
            --card-secondary: #f59e0b; 
        }
        .card-danger { 
            --card-primary: #dc2626; 
            --card-secondary: #ef4444; 
        }
        
        /* Floating Elements */
        .card-floating-element {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.05);
            pointer-events: none;
            z-index: 1;
        }
        
        .card-floating-1 {
            width: 120px;
            height: 120px;
            top: -60px;
            right: -60px;
            animation: float-1 6s ease-in-out infinite;
        }
        
        .card-floating-2 {
            width: 80px;
            height: 80px;
            bottom: -40px;
            left: -40px;
            animation: float-2 8s ease-in-out infinite reverse;
        }
        
        @keyframes float-1 {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(180deg); }
        }
        
        @keyframes float-2 {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(10px) rotate(-180deg); }
        }
        
        /* Professional Buttons */
        .btn-corporate {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            font-weight: 600;
            letter-spacing: 0.025em;
            border: 1px solid transparent;
        }
        
        .btn-corporate::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.4s ease;
        }
        
        .btn-corporate:hover::before {
            left: 100%;
        }
        
        .btn-corporate:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .btn-corporate:active {
            transform: translateY(0);
            box-shadow: var(--shadow-md);
        }
        
        /* Premium Table Design */
        .table-corporate {
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--neutral-200);
        }
        
        .table-corporate tbody tr {
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            border-bottom: 1px solid var(--neutral-100);
        }
        
        .table-corporate tbody tr:hover {
            background: linear-gradient(135deg, var(--primary-50) 0%, var(--neutral-50) 100%) !important;
            transform: scale(1.005);
            box-shadow: var(--shadow-sm);
        }
        
        .table-corporate tbody tr:last-child {
            border-bottom: none;
        }
        
        /* Professional Loading Animation */
        .loading-corporate {
            width: 48px;
            height: 48px;
            border: 3px solid var(--neutral-200);
            border-top: 3px solid var(--primary-500);
            border-radius: 50%;
            animation: spin-corporate 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
            position: relative;
        }
        
        .loading-corporate::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            right: 2px;
            bottom: 2px;
            border: 2px solid transparent;
            border-top: 2px solid var(--primary-300);
            border-radius: 50%;
            animation: spin-corporate 1.5s linear infinite reverse;
        }
        
        @keyframes spin-corporate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Executive Search Input */
        .search-corporate {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid var(--neutral-200);
            background: var(--neutral-50);
            font-weight: 500;
        }
        
        .search-corporate:focus {
            border-color: var(--primary-500);
            background: white;
            box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
            transform: scale(1.01);
        }
        
        .search-corporate::placeholder {
            color: var(--neutral-400);
            font-weight: 400;
        }
        
        /* Professional Pagination */
        .pagination-corporate {
            transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--neutral-300);
            background: white;
            font-weight: 500;
        }
        
        .pagination-corporate:hover:not(:disabled) {
            background: var(--primary-50);
            border-color: var(--primary-300);
            color: var(--primary-700);
            transform: translateY(-1px);
            box-shadow: var(--shadow-sm);
        }
        
        .pagination-corporate.active {
            background: var(--primary-500);
            border-color: var(--primary-500);
            color: white;
            box-shadow: var(--shadow-md);
        }
        
        /* Executive Header */
        .header-corporate {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            color: white;
        }
        
        .header-corporate::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #11998e 0%, #38ef7d 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
        }
        
        .header-corporate::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 50%, rgba(0,0,0,0.1) 100%);
            pointer-events: none;
        }
        
        /* Mobile-first responsive design */
        .mobile-card {
            display: none;
            padding: 16px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
        }
        
        .mobile-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border: 2px solid #e5e7eb;
            position: relative;
            overflow: hidden;
        }
        
        .mobile-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 6px;
            height: 100%;
            background: #e5e7eb;
        }
        
        .mobile-item.low-qty {
            border-color: #ef4444;
            background: linear-gradient(135deg, #ffffff 0%, #fef2f2 100%);
        }
        
        .mobile-item.low-qty::before {
            background: linear-gradient(180deg, #ef4444 0%, #dc2626 100%);
        }
        
        .mobile-item.medium-qty {
            border-color: #f59e0b;
            background: linear-gradient(135deg, #ffffff 0%, #fffbeb 100%);
        }
        
        .mobile-item.medium-qty::before {
            background: linear-gradient(180deg, #f59e0b 0%, #d97706 100%);
        }
        
        .mobile-item.high-qty {
            border-color: #10b981;
            background: linear-gradient(135deg, #ffffff 0%, #f0fdf4 100%);
        }
        
        .mobile-item.high-qty::before {
            background: linear-gradient(180deg, #10b981 0%, #059669 100%);
        }
        
        .mobile-header {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            color: white;
            padding: 16px 20px;
            border-radius: 12px 12px 0 0;
            margin: -20px -20px 16px -20px;
            border-bottom: 3px solid #3b82f6;
        }
        
        .mobile-item-title {
            font-size: 15px;
            font-weight: 700;
            color: white;
            margin-bottom: 4px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 100%;
        }
        
        .mobile-item-id {
            font-size: 12px;
            color: #cbd5e1;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 500;
        }
        
        .mobile-field {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
            gap: 12px;
        }
        
        .mobile-field:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }
        
        .mobile-label {
            font-size: 12px;
            font-weight: 700;
            color: #475569;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            flex-shrink: 0;
            min-width: 90px;
            max-width: 90px;
            line-height: 1.2;
        }
        
        .mobile-value {
            font-size: 14px;
            color: #0f172a;
            font-weight: 600;
            text-align: right;
            max-width: 60%;
            word-break: break-word;
            line-height: 1.3;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .mobile-value.multiline {
            white-space: normal;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .mobile-qty {
            font-size: 24px;
            font-weight: 900;
            color: #0f172a;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .mobile-qty-container {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            margin: 8px 0;
            border: 1px solid #cbd5e1;
        }
        
        .mobile-status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-top: 4px;
        }
        
        .mobile-status-critical {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }
        
        .mobile-status-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }
        
        .mobile-status-normal {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }
        
        .mobile-controls {
            position: sticky;
            top: 0;
            z-index: 10;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            padding: 16px;
            border-bottom: 2px solid #e2e8f0;
            margin: -16px -16px 20px -16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border-radius: 0 0 12px 12px;
        }
        
        .mobile-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            padding: 20px 16px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-top: 2px solid #cbd5e1;
            border-radius: 12px 12px 0 0;
        }
        
        .mobile-page-btn {
            padding: 12px 20px;
            border: 2px solid #cbd5e1;
            border-radius: 10px;
            background: white;
            color: #1e293b;
            font-size: 15px;
            font-weight: 700;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .mobile-page-btn:hover:not(:disabled) {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3);
        }
        
        .mobile-page-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            background: #f1f5f9;
            color: #94a3b8;
        }
        
        .mobile-page-btn.active {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border-color: #3b82f6;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        
        .mobile-page-info {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 600;
            color: #475569;
        }
        
        /* Mobile Dashboard Cards */
        .mobile-dashboard-card {
            background: linear-gradient(135deg, var(--card-primary) 0%, var(--card-secondary) 100%);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
            margin-bottom: 16px;
        }
        
        .mobile-dashboard-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, transparent 50%, rgba(0,0,0,0.1) 100%);
            pointer-events: none;
        }
        
        .mobile-dashboard-card .card-icon {
            width: 48px;
            height: 48px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
            backdrop-filter: blur(10px);
        }
        
        .mobile-dashboard-card .card-icon svg {
            width: 24px;
            height: 24px;
            color: white;
        }
        
        .mobile-dashboard-card .card-title {
            color: rgba(255, 255, 255, 0.9);
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 8px;
        }
        
        .mobile-dashboard-card .card-value {
            color: white;
            font-size: 28px;
            font-weight: 900;
            line-height: 1;
            margin-bottom: 4px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .mobile-dashboard-card .card-unit {
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
            font-weight: 600;
        }
        
        .mobile-dashboard-card .card-status {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.8);
            animation: pulse 2s infinite;
        }
        
        /* Real-time Status Indicator */
        .realtime-status {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
            border: 1px solid #475569;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .realtime-status-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
        }
        
        .realtime-status-title {
            color: white;
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .realtime-status-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .realtime-status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .realtime-status-dot.live {
            background: #22c55e;
        }
        
        .realtime-status-dot.recent {
            background: #f59e0b;
        }
        
        .realtime-status-dot.stale {
            background: #ef4444;
        }
        
        .realtime-status-text {
            color: white;
            font-size: 12px;
            font-weight: 600;
        }
        
        .realtime-status-info {
            color: #cbd5e1;
            font-size: 12px;
            line-height: 1.4;
        }
        
        .realtime-status-time {
            color: white;
            font-weight: 600;
        }
        
        /* Responsive breakpoints */
        @media (max-width: 1024px) {
            .dashboard-grid { 
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding-left: 16px;
                padding-right: 16px;
            }
            
            .dashboard-grid { 
                display: none; /* Hide desktop cards */
            }
            
            .mobile-dashboard-grid {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
                margin-bottom: 20px;
            }
            
            .table-container { 
                display: none;
            }
            
            .mobile-card {
                display: block;
            }
            
            .btn-enhanced {
                padding: 10px 16px;
                font-size: 14px;
            }
            
            .search-enhanced {
                font-size: 16px; /* Prevents zoom on iOS */
            }
        }
        
        @media (max-width: 640px) {
            .mobile-dashboard-grid { 
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .mobile-controls {
                margin: -16px -16px 16px -16px;
            }
            
            .controls-mobile {
                flex-direction: column;
                gap: 12px;
            }
            
            .controls-mobile > div {
                width: 100%;
            }
            
            .export-buttons {
                display: flex;
                gap: 8px;
            }
            
            .export-buttons button {
                flex: 1;
                padding: 12px 8px;
                font-size: 12px;
            }
        }
        
        @media (max-width: 480px) {
            .container {
                padding-left: 8px;
                padding-right: 8px;
            }
            
            .header-gradient {
                padding: 16px;
                margin-bottom: 16px;
            }
            
            .header-gradient h1 {
                font-size: 20px;
            }
            
            .header-gradient p {
                font-size: 14px;
            }
            
            .dashboard-card {
                padding: 8px;
            }
            
            .dashboard-card h3 {
                font-size: 10px;
            }
            
            .dashboard-card p {
                font-size: 16px;
            }
        }
        
        /* Custom scrollbar */
        .table-container::-webkit-scrollbar {
            height: 8px;
        }
        .table-container::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }
        .table-container::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        .table-container::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        /* Fade in animation */
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-in-out;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Status indicators */
        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-low { background-color: #ef4444; }
        .status-medium { background-color: #f59e0b; }
        .status-high { background-color: #10b981; }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 via-blue-50 to-pink-50 min-h-screen">
    <div class="container mx-auto px-4 py-6">
        <!-- Professional Modern Header -->
        <div class="header-corporate rounded-2xl shadow-2xl p-8 mb-8 relative overflow-hidden">
            <!-- Animated Background Pattern -->
            <div class="absolute inset-0 opacity-10">
                <div class="absolute top-0 left-0 w-32 h-32 bg-white rounded-full -translate-x-16 -translate-y-16"></div>
                <div class="absolute top-0 right-0 w-24 h-24 bg-white rounded-full translate-x-12 -translate-y-12"></div>
                <div class="absolute bottom-0 left-1/3 w-20 h-20 bg-white rounded-full translate-y-10"></div>
            </div>
            
            <div class="relative z-10 flex items-center justify-between">
                <div class="flex-1">
                    <div class="flex items-center space-x-4 mb-4">
                        <!-- Modern Logo Icon -->
                        <div class="w-16 h-16 bg-white/20 rounded-2xl backdrop-blur-sm flex items-center justify-center border border-white/30">
                            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                            </svg>
                        </div>
                        <div>
                            <h1 class="text-4xl font-black text-white mb-1 tracking-tight">
                                InventoryPro
                            </h1>
                            <p class="text-white/80 text-lg font-medium">Advanced Warehouse Management</p>
                        </div>
                    </div>
                    
                    <!-- Status Bar -->
                    <div class="flex items-center space-x-6 text-sm">
                        <div class="flex items-center space-x-2 bg-white/10 rounded-full px-4 py-2 backdrop-blur-sm">
                            <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                            <span class="text-white font-semibold">LIVE DATA</span>
                        </div>
                        <div class="flex items-center space-x-2 text-white/70">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path>
                            </svg>
                            <span id="lastUpdated" class="font-medium">Loading...</span>
                        </div>
                    </div>
                </div>
                
                <!-- System Status (Desktop) -->
                <div class="hidden lg:flex items-center space-x-4">
                    <div class="text-right">
                        <div class="text-3xl font-black text-white drop-shadow-lg" id="systemStatus">ONLINE</div>
                        <div class="text-sm text-white/60 font-medium uppercase tracking-wider">System Status</div>
                    </div>
                    <div class="w-4 h-4 bg-green-400 rounded-full animate-pulse shadow-lg ring-4 ring-green-400/30"></div>
                </div>
            </div>
        </div>

        <!-- Mobile Status (Mobile Only) -->
        <div class="realtime-status md:hidden">
            <div class="realtime-status-header">
                <div class="realtime-status-title">Data Status</div>
                <div class="realtime-status-indicator">
                    <div class="realtime-status-dot live" id="mobileStatusDot"></div>
                    <div class="realtime-status-text" id="mobileStatusText">LIVE</div>
                </div>
            </div>
            <div class="realtime-status-info">
                Last updated: <span class="realtime-status-time" id="mobileLastUpdated">Checking...</span>
            </div>
        </div>

        <!-- Mobile Dashboard Cards (Mobile Only) -->
        <div class="mobile-dashboard-grid md:hidden">
            <!-- Total Inventory Card -->
            <div class="mobile-dashboard-card card-primary">
                <div class="card-status"></div>
                <div class="card-icon">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                    </svg>
                </div>
                <div class="relative z-10">
                    <div class="card-title">Total Inventory</div>
                    <div class="card-value" id="mobileTotalQty">0</div>
                    <div class="card-unit">units</div>
                </div>
            </div>

            <!-- Base Quantity Card -->
            <div class="mobile-dashboard-card card-success">
                <div class="card-status"></div>
                <div class="card-icon">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                </div>
                <div class="relative z-10">
                    <div class="card-title">Base Quantity</div>
                    <div class="card-value" id="mobileTotalBaseQty">0</div>
                    <div class="card-unit">base</div>
                </div>
            </div>

            <!-- Unique Items Card -->
            <div class="mobile-dashboard-card card-warning">
                <div class="card-status"></div>
                <div class="card-icon">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                    </svg>
                </div>
                <div class="relative z-10">
                    <div class="card-title">Unique Items</div>
                    <div class="card-value" id="mobileUniqueItems">0</div>
                    <div class="card-unit">types</div>
                </div>
            </div>

            <!-- Low Stock Alert Card -->
            <div class="mobile-dashboard-card card-danger">
                <div class="card-status"></div>
                <div class="card-icon">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                    </svg>
                </div>
                <div class="relative z-10">
                    <div class="card-title">Low Stock Alert</div>
                    <div class="card-value" id="mobileLowQtyItems">0</div>
                    <div class="card-unit">items</div>
                </div>
            </div>
        </div>

        <!-- Professional Executive Dashboard Cards (Desktop Only) -->
        <div class="grid dashboard-grid grid-cols-4 gap-8 mb-8 hidden md:grid">
            <!-- Total Inventory Card -->
            <div class="executive-card card-primary rounded-3xl p-8 overflow-hidden">
                <!-- Floating Elements -->
                <div class="card-floating-element card-floating-1"></div>
                <div class="card-floating-element card-floating-2"></div>
                
                <!-- Status Dot -->
                <div class="card-status-dot"></div>
                
                <!-- Content -->
                <div class="card-content">
                    <div class="flex items-start justify-between mb-6">
                        <div class="card-icon-container p-4 rounded-2xl">
                            <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                            </svg>
                        </div>
                    </div>
                    <h3 class="card-title-enhanced">Total Inventory</h3>
                    <div class="flex items-baseline space-x-3">
                        <p class="card-value-enhanced" id="totalQty">0</p>
                        <span class="card-unit-enhanced">units</span>
                    </div>
                    <div class="card-metric-info">
                        <svg fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                        <span>Total stock available</span>
                    </div>
                </div>
            </div>

            <!-- Base Quantity Card -->
            <div class="executive-card card-success rounded-3xl p-8 overflow-hidden">
                <!-- Floating Elements -->
                <div class="card-floating-element card-floating-1"></div>
                <div class="card-floating-element card-floating-2"></div>
                
                <!-- Status Dot -->
                <div class="card-status-dot"></div>
                
                <!-- Content -->
                <div class="card-content">
                    <div class="flex items-start justify-between mb-6">
                        <div class="card-icon-container p-4 rounded-2xl">
                            <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                            </svg>
                        </div>
                    </div>
                    <h3 class="card-title-enhanced">Base Quantity</h3>
                    <div class="flex items-baseline space-x-3">
                        <p class="card-value-enhanced" id="totalBaseQty">0</p>
                        <span class="card-unit-enhanced">base</span>
                    </div>
                    <div class="card-metric-info">
                        <svg fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path>
                        </svg>
                        <span>Base units measurement</span>
                    </div>
                </div>
            </div>

            <!-- Unique Items Card -->
            <div class="executive-card card-warning rounded-3xl p-8 overflow-hidden">
                <!-- Floating Elements -->
                <div class="card-floating-element card-floating-1"></div>
                <div class="card-floating-element card-floating-2"></div>
                
                <!-- Status Dot -->
                <div class="card-status-dot"></div>
                
                <!-- Content -->
                <div class="card-content">
                    <div class="flex items-start justify-between mb-6">
                        <div class="card-icon-container p-4 rounded-2xl">
                            <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                            </svg>
                        </div>
                    </div>
                    <h3 class="card-title-enhanced">Unique Items</h3>
                    <div class="flex items-baseline space-x-3">
                        <p class="card-value-enhanced" id="uniqueItems">0</p>
                        <span class="card-unit-enhanced">types</span>
                    </div>
                    <div class="card-metric-info">
                        <svg fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                        <span>Product variations</span>
                    </div>
                </div>
            </div>

            <!-- Low Stock Alert Card -->
            <div class="executive-card card-danger rounded-3xl p-8 overflow-hidden">
                <!-- Floating Elements -->
                <div class="card-floating-element card-floating-1"></div>
                <div class="card-floating-element card-floating-2"></div>
                
                <!-- Status Dot -->
                <div class="card-status-dot"></div>
                
                <!-- Content -->
                <div class="card-content">
                    <div class="flex items-start justify-between mb-6">
                        <div class="card-icon-container p-4 rounded-2xl">
                            <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                            </svg>
                        </div>
                    </div>
                    <h3 class="card-title-enhanced">Low Stock Alert</h3>
                    <div class="flex items-baseline space-x-3">
                        <p class="card-value-enhanced" id="lowQtyItems">0</p>
                        <span class="card-unit-enhanced">items</span>
                    </div>
                    <div class="card-metric-info">
                        <svg fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                        </svg>
                        <span>Requires attention</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Top Items Analysis Section - Collapsible -->
        <div class="bg-white rounded-lg shadow-md border border-neutral-200 p-4 mb-6">
            <div class="flex items-center justify-between mb-3 cursor-pointer" onclick="toggleTopItems()">
                <div class="flex items-center space-x-2">
                    <div class="w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                        </svg>
                    </div>
                    <div>
                        <h2 class="text-sm font-bold text-neutral-800">Top Items Analysis</h2>
                        <p class="text-neutral-500 text-xs">Click to expand • Highest quantities</p>
                    </div>
                </div>
                <div class="flex items-center space-x-3">
                    <div class="flex items-center space-x-1 text-xs text-neutral-500">
                        <div class="w-1.5 h-1.5 bg-purple-500 rounded-full animate-pulse"></div>
                        <span>Live</span>
                    </div>
                    <button class="p-1 hover:bg-neutral-100 rounded transition-colors">
                        <svg id="topItemsToggleIcon" class="w-4 h-4 text-neutral-600 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                </div>
            </div>
            
            <!-- Compact Top Items Grid - Hidden by default -->
            <div id="topItemsContent" class="hidden transition-all duration-300 ease-in-out">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                <!-- Top 3 Items by Quantity -->
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-3 border border-blue-200">
                    <div class="flex items-center space-x-2 mb-2">
                        <div class="w-5 h-5 bg-blue-500 rounded flex items-center justify-center">
                            <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                            </svg>
                        </div>
                        <h3 class="text-xs font-bold text-blue-900">Top 10 by Quantity</h3>
                    </div>
                    <div id="topItemsByQty" class="space-y-2">
                        <!-- Top items akan dimuat di sini -->
                    </div>
                </div>
                
                <!-- Top 3 Items by Base Quantity -->
                <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-3 border border-green-200">
                    <div class="flex items-center space-x-2 mb-2">
                        <div class="w-5 h-5 bg-green-500 rounded flex items-center justify-center">
                            <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                            </svg>
                        </div>
                        <h3 class="text-xs font-bold text-green-900">Top 10 by Base Qty</h3>
                    </div>
                    <div id="topItemsByBaseQty" class="space-y-2">
                        <!-- Top base items akan dimuat di sini -->
                    </div>
                </div>
                
                <!-- Mobile Top Items (Mobile Only) -->
                    <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-3 border border-purple-200">
                        <div class="flex items-center space-x-2 mb-2">
                            <div class="w-5 h-5 bg-purple-500 rounded flex items-center justify-center">
                                <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path>
                                </svg>
                            </div>
                            <h3 class="text-xs font-bold text-purple-900">Top 10 Items</h3>
                        </div>
                        <div id="mobileTopItems" class="space-y-2">
                            <!-- Mobile top items akan dimuat di sini -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Control Panel -->
        <div class="bg-white rounded-xl shadow-lg border border-neutral-200 p-8 mb-8">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold text-neutral-800">Control Panel</h2>
                <div class="flex items-center space-x-2 text-sm text-neutral-500">
                    <div class="w-2 h-2 bg-success-500 rounded-full"></div>
                    <span>Live Feed</span>
                </div>
            </div>
            <div class="controls-mobile flex flex-col lg:flex-row gap-6 items-center justify-between">
                <div class="flex flex-col md:flex-row gap-4 flex-1 w-full">
                    <div class="relative flex-1">
                        <svg class="absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        <input type="text" id="searchInput" placeholder="Search by item name or ID..." 
                               class="search-corporate flex-1 pl-12 pr-4 py-3 rounded-xl focus:ring-2 focus:ring-primary-500 focus:border-transparent text-neutral-700">
                    </div>
                    <button onclick="refreshData()" id="refreshBtn" class="group relative overflow-hidden bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-800 text-white px-8 py-4 rounded-xl font-bold text-sm uppercase tracking-wider transition-all duration-300 hover:scale-105 hover:shadow-xl border border-blue-500/30 backdrop-blur-sm">
                        <!-- Background Animation -->
                        <div class="absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 -translate-x-full group-hover:translate-x-full transition-transform duration-700"></div>
                        
                        <!-- Content -->
                        <div class="relative flex items-center space-x-3">
                            <div class="p-2 bg-white/20 rounded-lg backdrop-blur-sm group-hover:bg-white/30 transition-colors">
                                <svg class="w-5 h-5 transition-transform duration-300 group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                                </svg>
                            </div>
                            <div class="flex flex-col items-start">
                                <span class="text-white font-black text-base">Refresh Data</span>
                                <span class="text-white/70 text-xs font-medium">Update inventory</span>
                            </div>
                        </div>
                        
                        <!-- Status Indicator -->
                        <div class="absolute top-2 right-2">
                            <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                        </div>
                    </button>
                </div>
                <div class="export-buttons flex gap-3 w-full lg:w-auto">
                    <button onclick="exportToPDF()" class="btn-corporate px-8 py-3 bg-gradient-to-r from-red-500 to-pink-500 text-white rounded-xl hover:from-red-600 hover:to-pink-600 transition-all duration-300 flex items-center space-x-2 shadow-lg">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                        </svg>
                        <span>Export PDF</span>
                    </button>
                    <button onclick="exportToExcel()" class="btn-corporate px-8 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-xl hover:from-green-600 hover:to-emerald-600 transition-all duration-300 flex items-center space-x-2 shadow-lg">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        <span>Export Excel</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Professional Loading Indicator -->
        <div id="loadingIndicator" class="text-center py-12">
            <div class="loading-corporate mx-auto"></div>
            <p class="mt-6 text-neutral-600 font-semibold text-lg">Loading enterprise data...</p>
            <p class="text-neutral-400 text-sm mt-2">Connecting to secure data sources</p>
        </div>

        <!-- Executive Data Table -->
        <div class="table-corporate bg-white overflow-hidden">
            <div class="table-container overflow-x-auto">
                <table class="w-full" id="dataTable">
                    <thead class="table-header">
                        <tr>
                            <th class="sortable px-6 py-4 text-left text-xs font-bold text-neutral-700 uppercase tracking-wider" data-column="0">Location ID</th>
                            <th class="sortable px-6 py-4 text-left text-xs font-bold text-neutral-700 uppercase tracking-wider" data-column="1">Item ID</th>
                            <th class="sortable px-6 py-4 text-left text-xs font-bold text-neutral-700 uppercase tracking-wider" data-column="2">Product Name</th>
                            <th class="sortable px-6 py-4 text-left text-xs font-bold text-neutral-700 uppercase tracking-wider" data-column="3">Pallet</th>
                            <th class="sortable px-6 py-4 text-left text-xs font-bold text-neutral-700 uppercase tracking-wider" data-column="4">Pallet No</th>
                            <th class="sortable px-6 py-4 text-left text-xs font-bold text-neutral-700 uppercase tracking-wider" data-column="5">Transaction Date</th>
                            <th class="sortable px-6 py-4 text-left text-xs font-bold text-neutral-700 uppercase tracking-wider" data-column="6">Production Date</th>
                            <th class="sortable px-6 py-4 text-left text-xs font-bold text-neutral-700 uppercase tracking-wider" data-column="7">Expiry Date</th>
                            <th class="sortable px-6 py-4 text-left text-xs font-bold text-neutral-700 uppercase tracking-wider" data-column="8">Batch</th>
                            <th class="sortable px-6 py-4 text-left text-xs font-bold text-neutral-700 uppercase tracking-wider" data-column="9">Container ID</th>
                            <th class="sortable px-6 py-4 text-left text-xs font-bold text-neutral-700 uppercase tracking-wider" data-column="10">Quantity</th>
                            <th class="sortable px-6 py-4 text-left text-xs font-bold text-neutral-700 uppercase tracking-wider" data-column="11">UOM</th>
                            <th class="sortable px-6 py-4 text-left text-xs font-bold text-neutral-700 uppercase tracking-wider" data-column="12">Base Qty</th>
                            <th class="sortable px-6 py-4 text-left text-xs font-bold text-neutral-700 uppercase tracking-wider" data-column="13">Base UOM</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody" class="bg-white">
                        <!-- Data akan dimuat di sini -->
                    </tbody>
                </table>
            </div>
            
            <!-- Mobile Card View -->
            <div class="mobile-card" id="mobileCardContainer">
                <!-- Mobile cards akan dimuat di sini -->
            </div>
            
            <!-- Executive Pagination -->
            <div class="bg-neutral-50 px-8 py-6 flex items-center justify-between border-t border-neutral-200">
                <div class="flex-1 flex justify-between sm:hidden">
                    <button onclick="previousPage()" class="pagination-corporate relative inline-flex items-center px-6 py-3 text-sm font-semibold rounded-lg">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                        Previous
                    </button>
                    <button onclick="nextPage()" class="pagination-corporate relative inline-flex items-center px-6 py-3 text-sm font-semibold rounded-lg">
                        Next
                        <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </button>
                </div>
                <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
                    <div class="flex items-center space-x-4">
                        <p class="text-sm font-medium text-neutral-700">
                            Showing <span class="font-bold text-primary-600" id="showingStart">0</span> to <span class="font-bold text-primary-600" id="showingEnd">0</span> of <span class="font-bold text-primary-600" id="totalRecords">0</span> records
                        </p>
                        <div class="flex items-center space-x-2 text-xs text-neutral-500">
                            <div class="w-2 h-2 bg-primary-500 rounded-full animate-pulse"></div>
                            <span>Real-time data</span>
                        </div>
                    </div>
                    <div>
                        <nav class="relative z-0 inline-flex rounded-lg shadow-sm space-x-1" id="paginationNav">
                            <!-- Pagination buttons akan dimuat di sini -->
                        </nav>
                    </div>
                </div>
            </div>
            
            <!-- Mobile Executive Pagination -->
            <div class="mobile-pagination md:hidden bg-neutral-50 border-t border-neutral-200" id="mobilePagination">
                <!-- Mobile pagination akan dimuat di sini -->
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let allData = [];
        let filteredData = [];
        let currentPage = 1;
        const itemsPerPage = 50;
        let sortColumn = -1;
        let sortDirection = 'asc';

        // API Configuration
        const API_KEY = 'AIzaSyCfnSym_wpPtzWL0P3-kslY1Y14B7nD-34';
        const SPREADSHEET_ID = '17OkeTOaqGcx-2BZe7POwXizqDq3AUu6fjPc38izGv2w';
        const RANGE = 'A:N'; // Will try multiple sheet names

        // Initialize application
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            setupEventListeners();
            startAutoRefresh(); // Start real-time monitoring
        });

        function setupEventListeners() {
            // Search functionality
            document.getElementById('searchInput').addEventListener('input', function() {
                filterData();
            });

            // Sortable headers
            document.querySelectorAll('.sortable').forEach(header => {
                header.addEventListener('click', function() {
                    const column = parseInt(this.dataset.column);
                    sortData(column);
                });
            });
        }

        async function loadData() {
            try {
                document.getElementById('loadingIndicator').style.display = 'block';
                console.log('Loading data from Google Sheets...');
                
                // Get spreadsheet metadata to check last modified time
                let lastModified = null;
                let spreadsheetTitle = 'Unknown';
                try {
                    const metadataUrl = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}?key=${API_KEY}&fields=properties.title,properties.timeZone,sheets.properties.title`;
                    const metadataResponse = await fetch(metadataUrl);
                    if (metadataResponse.ok) {
                        const metadata = await metadataResponse.json();
                        spreadsheetTitle = metadata.properties?.title || 'Unknown';
                        console.log('Spreadsheet metadata:', metadata);
                        

                    }
                } catch (e) {
                    console.log('Could not fetch metadata:', e.message);
                }
                
                // Get file metadata from Drive API for last modified time
                try {
                    const driveUrl = `https://www.googleapis.com/drive/v3/files/${SPREADSHEET_ID}?key=${API_KEY}&fields=modifiedTime,name,owners`;
                    const driveResponse = await fetch(driveUrl);
                    if (driveResponse.ok) {
                        const driveData = await driveResponse.json();
                        if (driveData.modifiedTime) {
                            lastModified = new Date(driveData.modifiedTime);
                            console.log('Last modified:', lastModified);
                            
                            // Update last modified display
                            const lastModifiedElement = document.getElementById('lastUpdated');
                            if (lastModifiedElement) {
                                const timeAgo = getTimeAgo(lastModified);
                                lastModifiedElement.innerHTML = `
                                    <span class="font-bold">${lastModified.toLocaleString()}</span>
                                    <span class="text-xs opacity-75 ml-2">(${timeAgo})</span>
                                `;
                            }
                            
                            // Update mobile last updated display
                            const mobileLastUpdated = document.getElementById('mobileLastUpdated');
                            if (mobileLastUpdated) {
                                const timeAgo = getTimeAgo(lastModified);
                                mobileLastUpdated.textContent = `${lastModified.toLocaleString()} (${timeAgo})`;
                            }
                        }
                        
                        // Update system status based on how recent the data is
                        if (lastModified) {
                            const minutesAgo = (new Date() - lastModified) / (1000 * 60);
                            const systemStatus = document.getElementById('systemStatus');
                            const statusIndicator = systemStatus.parentElement.querySelector('.animate-pulse');
                            
                            // Mobile status elements
                            const mobileStatusDot = document.getElementById('mobileStatusDot');
                            const mobileStatusText = document.getElementById('mobileStatusText');
                            
                            if (minutesAgo < 5) {
                                // Desktop status
                                systemStatus.textContent = 'LIVE';
                                systemStatus.className = 'text-2xl font-bold text-green-300 drop-shadow-lg';
                                statusIndicator.className = 'w-3 h-3 bg-green-400 rounded-full animate-pulse shadow-lg';
                                
                                // Mobile status
                                if (mobileStatusDot && mobileStatusText) {
                                    mobileStatusDot.className = 'realtime-status-dot live';
                                    mobileStatusText.textContent = 'LIVE';
                                }
                            } else if (minutesAgo < 30) {
                                // Desktop status
                                systemStatus.textContent = 'RECENT';
                                systemStatus.className = 'text-2xl font-bold text-yellow-300 drop-shadow-lg';
                                statusIndicator.className = 'w-3 h-3 bg-yellow-400 rounded-full animate-pulse shadow-lg';
                                
                                // Mobile status
                                if (mobileStatusDot && mobileStatusText) {
                                    mobileStatusDot.className = 'realtime-status-dot recent';
                                    mobileStatusText.textContent = 'RECENT';
                                }
                            } else {
                                // Desktop status
                                systemStatus.textContent = 'STALE';
                                systemStatus.className = 'text-2xl font-bold text-orange-300 drop-shadow-lg';
                                statusIndicator.className = 'w-3 h-3 bg-orange-400 rounded-full animate-pulse shadow-lg';
                                
                                // Mobile status
                                if (mobileStatusDot && mobileStatusText) {
                                    mobileStatusDot.className = 'realtime-status-dot stale';
                                    mobileStatusText.textContent = 'STALE';
                                }
                            }
                        }
                    }
                } catch (e) {
                    console.log('Could not fetch Drive metadata:', e.message);
                }
                
                // Try different sheet names and ranges
                const possibleRanges = [
                    'A:N',
                    'Sheet1!A:N', 
                    'Lembar1!A:N',
                    'Data!A:N',
                    'Inventory!A:N'
                ];
                
                let data = null;
                let successUrl = '';
                
                for (const range of possibleRanges) {
                    try {
                        const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${range}?key=${API_KEY}`;
                        console.log('Trying URL:', url);
                        
                        const response = await fetch(url);
                        
                        if (response.ok) {
                            const testData = await response.json();
                            if (testData.values && testData.values.length > 0) {
                                data = testData;
                                successUrl = url;
                                console.log(`Success with range: ${range}`);
                                break;
                            }
                        }
                    } catch (e) {
                        console.log(`Failed with range ${range}:`, e.message);
                        continue;
                    }
                }
                
                if (!data) {
                    throw new Error('Could not access spreadsheet with any sheet name. Please ensure the spreadsheet is publicly accessible (Anyone with link can view)');
                }
                
                console.log('Data received:', data);
                
                if (data.values && data.values.length > 0) {
                    console.log('Total rows:', data.values.length);
                    
                    // Check if first row looks like headers
                    const hasHeaders = data.values[0].some(cell => 
                        typeof cell === 'string' && 
                        (cell.toLowerCase().includes('location') || 
                         cell.toLowerCase().includes('item') || 
                         cell.toLowerCase().includes('qty'))
                    );
                    
                    // Skip header row if it exists
                    const dataRows = hasHeaders ? data.values.slice(1) : data.values;
                    
                    allData = dataRows.map(row => {
                        // Ensure all columns exist
                        while (row.length < 14) {
                            row.push('');
                        }
                        return row;
                    });
                    
                    console.log('Processed data rows:', allData.length);
                    
                    filteredData = [...allData];
                    updateDashboard();
                    renderTable();
                    updatePagination();
                    updateTimestamp();
                    
                    // Show success message
                    if (allData.length > 0) {
                        console.log('Data loaded successfully!');
                    } else {
                        throw new Error('No data rows found after processing');
                    }
                } else {
                    throw new Error('No data found in spreadsheet or sheet is empty');
                }
                
            } catch (error) {
                console.error('Error loading data:', error);
                document.getElementById('tableBody').innerHTML = `
                    <tr>
                        <td colspan="14" class="px-4 py-8 text-center text-red-600">
                            ❌ Error memuat data: ${error.message}<br>
                            <small class="text-gray-500 mt-2 block">
                                Pastikan spreadsheet dapat diakses publik dan API key valid.<br>
                                Cek console browser untuk detail error.
                            </small>
                        </td>
                    </tr>
                `;
            } finally {
                document.getElementById('loadingIndicator').style.display = 'none';
            }
        }

        function updateDashboard() {
            const totalQty = filteredData.reduce((sum, row) => sum + (parseFloat(row[10]) || 0), 0);
            const totalBaseQty = filteredData.reduce((sum, row) => sum + (parseFloat(row[12]) || 0), 0);
            const uniqueItems = new Set(filteredData.map(row => row[1])).size;
            const lowQtyItems = filteredData.filter(row => (parseFloat(row[10]) || 0) < 10).length;

            // Update desktop dashboard
            document.getElementById('totalQty').textContent = totalQty.toLocaleString();
            document.getElementById('totalBaseQty').textContent = totalBaseQty.toLocaleString();
            document.getElementById('uniqueItems').textContent = uniqueItems.toLocaleString();
            document.getElementById('lowQtyItems').textContent = lowQtyItems.toLocaleString();

            // Update mobile dashboard
            document.getElementById('mobileTotalQty').textContent = totalQty.toLocaleString();
            document.getElementById('mobileTotalBaseQty').textContent = totalBaseQty.toLocaleString();
            document.getElementById('mobileUniqueItems').textContent = uniqueItems.toLocaleString();
            document.getElementById('mobileLowQtyItems').textContent = lowQtyItems.toLocaleString();
            
            // Update top items analysis
            updateTopItemsAnalysis();
        }

        function updateTopItemsAnalysis() {
            // Group items by name and sum quantities
            const itemGroups = {};
            
            filteredData.forEach(row => {
                const itemName = row[2] || 'Unknown Item';
                const itemId = row[1] || 'Unknown ID';
                const qty = parseFloat(row[10]) || 0;
                const baseQty = parseFloat(row[12]) || 0;
                const uom = row[11] || '';
                const baseUom = row[13] || '';
                
                const key = `${itemName}_${itemId}`;
                
                if (!itemGroups[key]) {
                    itemGroups[key] = {
                        name: itemName,
                        id: itemId,
                        totalQty: 0,
                        totalBaseQty: 0,
                        uom: uom,
                        baseUom: baseUom,
                        locations: 0
                    };
                }
                
                itemGroups[key].totalQty += qty;
                itemGroups[key].totalBaseQty += baseQty;
                itemGroups[key].locations += 1;
            });
            
            // Convert to array and sort
            const itemsArray = Object.values(itemGroups);
            
            // Top 10 by quantity (minimized)
            const topByQty = itemsArray
                .sort((a, b) => b.totalQty - a.totalQty)
                .slice(0, 10);
            
            // Top 10 by base quantity (minimized)
            const topByBaseQty = itemsArray
                .sort((a, b) => b.totalBaseQty - a.totalBaseQty)
                .slice(0, 10);
            
            // Render compact top items by quantity
            const topQtyContainer = document.getElementById('topItemsByQty');
            if (topQtyContainer) {
                topQtyContainer.innerHTML = topByQty.map((item, index) => `
                    <div class="flex items-center justify-between p-2 bg-white rounded border border-blue-100 hover:border-blue-200 transition-colors">
                        <div class="flex items-center space-x-2">
                            <div class="w-5 h-5 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs font-bold">
                                ${index + 1}
                            </div>
                            <div class="flex-1 min-w-0">
                                <div class="text-xs font-semibold text-blue-900 truncate" title="${item.name}">
                                    ${item.name.length > 15 ? item.name.substring(0, 15) + '...' : item.name}
                                </div>
                                <div class="text-xs text-blue-600 font-mono opacity-75">
                                    ${item.id} • ${item.locations}x
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-sm font-bold text-blue-900">
                                ${item.totalQty.toLocaleString()}
                            </div>
                            <div class="text-xs text-blue-600 opacity-75">
                                ${item.uom}
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            // Render compact top items by base quantity
            const topBaseQtyContainer = document.getElementById('topItemsByBaseQty');
            if (topBaseQtyContainer) {
                topBaseQtyContainer.innerHTML = topByBaseQty.map((item, index) => `
                    <div class="flex items-center justify-between p-2 bg-white rounded border border-green-100 hover:border-green-200 transition-colors">
                        <div class="flex items-center space-x-2">
                            <div class="w-5 h-5 bg-green-500 text-white rounded-full flex items-center justify-center text-xs font-bold">
                                ${index + 1}
                            </div>
                            <div class="flex-1 min-w-0">
                                <div class="text-xs font-semibold text-green-900 truncate" title="${item.name}">
                                    ${item.name.length > 15 ? item.name.substring(0, 15) + '...' : item.name}
                                </div>
                                <div class="text-xs text-green-600 font-mono opacity-75">
                                    ${item.id} • ${item.locations}x
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-sm font-bold text-green-900">
                                ${item.totalBaseQty.toLocaleString()}
                            </div>
                            <div class="text-xs text-green-600 opacity-75">
                                ${item.baseUom}
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            
            // Render mobile top items (compact top 10)
            const mobileTopContainer = document.getElementById('mobileTopItems');
            if (mobileTopContainer) {
                const combinedTop = topByQty.slice(0, 10); // Show top 10 for mobile
                mobileTopContainer.innerHTML = combinedTop.map((item, index) => `
                    <div class="flex items-center justify-between p-2 bg-white rounded border border-purple-100 hover:border-purple-200 transition-colors">
                        <div class="flex items-center space-x-2">
                            <div class="w-5 h-5 bg-purple-500 text-white rounded-full flex items-center justify-center text-xs font-bold">
                                ${index + 1}
                            </div>
                            <div class="flex-1 min-w-0">
                                <div class="text-xs font-semibold text-purple-900 truncate" title="${item.name}">
                                    ${item.name.length > 12 ? item.name.substring(0, 12) + '...' : item.name}
                                </div>
                                <div class="text-xs text-purple-600 font-mono opacity-75">
                                    ${item.id}
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-sm font-bold text-purple-900">
                                ${item.totalQty.toLocaleString()}
                            </div>
                            <div class="text-xs text-purple-600 opacity-75">
                                ${item.uom}
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function filterData() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            if (searchTerm === '') {
                filteredData = [...allData];
            } else {
                filteredData = allData.filter(row => {
                    const itemName = (row[2] || '').toLowerCase();
                    const itemId = (row[1] || '').toLowerCase();
                    return itemName.includes(searchTerm) || itemId.includes(searchTerm);
                });
            }
            
            currentPage = 1;
            updateDashboard();
            renderTable();
            updatePagination();
        }

        function sortData(column) {
            if (sortColumn === column) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn = column;
                sortDirection = 'asc';
            }

            // Update header indicators
            document.querySelectorAll('.sortable').forEach(header => {
                header.classList.remove('sort-asc', 'sort-desc');
            });
            
            const currentHeader = document.querySelector(`[data-column="${column}"]`);
            currentHeader.classList.add(sortDirection === 'asc' ? 'sort-asc' : 'sort-desc');

            filteredData.sort((a, b) => {
                let aVal = a[column] || '';
                let bVal = b[column] || '';
                
                // Try to parse as numbers for numeric columns
                if (column === 10 || column === 12) { // Qty and Base Qty columns
                    aVal = parseFloat(aVal) || 0;
                    bVal = parseFloat(bVal) || 0;
                } else {
                    aVal = aVal.toString().toLowerCase();
                    bVal = bVal.toString().toLowerCase();
                }
                
                if (aVal < bVal) return sortDirection === 'asc' ? -1 : 1;
                if (aVal > bVal) return sortDirection === 'asc' ? 1 : -1;
                return 0;
            });

            renderTable();
        }

        function renderTable() {
            const tbody = document.getElementById('tableBody');
            const mobileContainer = document.getElementById('mobileCardContainer');
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageData = filteredData.slice(startIndex, endIndex);

            if (pageData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="14" class="px-8 py-12 text-center">
                            <div class="flex flex-col items-center space-y-4">
                                <svg class="w-16 h-16 text-neutral-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path>
                                </svg>
                                <div class="text-center">
                                    <h3 class="text-lg font-semibold text-neutral-700">No Data Found</h3>
                                    <p class="text-neutral-500 mt-1">No inventory records match your search criteria</p>
                                </div>
                            </div>
                        </td>
                    </tr>
                `;
                mobileContainer.innerHTML = `
                    <div class="text-center py-12">
                        <div class="flex flex-col items-center space-y-4">
                            <svg class="w-16 h-16 text-neutral-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path>
                            </svg>
                            <div class="text-center">
                                <h3 class="text-lg font-semibold text-neutral-700">No Data Found</h3>
                                <p class="text-neutral-500 mt-1">No inventory records match your search criteria</p>
                            </div>
                        </div>
                    </div>
                `;
                return;
            }

            // Render desktop table
            tbody.innerHTML = pageData.map(row => {
                const qty = parseFloat(row[10]) || 0;
                let rowClass = '';
                let statusBadge = '';
                
                if (qty < 10) {
                    rowClass = 'status-critical';
                    statusBadge = '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-danger-100 text-danger-800">Critical</span>';
                } else if (qty >= 10 && qty <= 50) {
                    rowClass = 'status-warning';
                    statusBadge = '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-warning-100 text-warning-800">Low</span>';
                } else {
                    rowClass = 'status-normal';
                    statusBadge = '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-success-100 text-success-800">Normal</span>';
                }

                return `
                    <tr class="${rowClass}">
                        <td class="px-6 py-4 text-sm font-medium text-neutral-900">${row[0] || '-'}</td>
                        <td class="px-6 py-4 text-sm text-neutral-700 font-mono">${row[1] || '-'}</td>
                        <td class="px-6 py-4 text-sm font-medium text-neutral-900">${row[2] || '-'}</td>
                        <td class="px-6 py-4 text-sm text-neutral-700">${row[3] || '-'}</td>
                        <td class="px-6 py-4 text-sm text-neutral-700">${row[4] || '-'}</td>
                        <td class="px-6 py-4 text-sm text-neutral-700">${row[5] || '-'}</td>
                        <td class="px-6 py-4 text-sm text-neutral-700">${row[6] || '-'}</td>
                        <td class="px-6 py-4 text-sm text-neutral-700">${row[7] || '-'}</td>
                        <td class="px-6 py-4 text-sm text-neutral-700 font-mono">${row[8] || '-'}</td>
                        <td class="px-6 py-4 text-sm text-neutral-700">${row[9] || '-'}</td>
                        <td class="px-6 py-4 text-sm">
                            <div class="flex items-center space-x-3">
                                <span class="text-lg font-bold text-neutral-900">${qty.toLocaleString()}</span>
                                ${statusBadge}
                            </div>
                        </td>
                        <td class="px-6 py-4 text-sm text-neutral-700">${row[11] || '-'}</td>
                        <td class="px-6 py-4 text-sm font-semibold text-neutral-900">${(parseFloat(row[12]) || 0).toLocaleString()}</td>
                        <td class="px-6 py-4 text-sm text-neutral-700">${row[13] || '-'}</td>
                    </tr>
                `;
            }).join('');

            // Render mobile cards
            mobileContainer.innerHTML = pageData.map(row => {
                const qty = parseFloat(row[10]) || 0;
                const baseQty = parseFloat(row[12]) || 0;
                let cardClass = '';
                let statusBadge = '';
                let statusClass = '';
                
                if (qty < 10) {
                    cardClass = 'low-qty';
                    statusBadge = 'CRITICAL';
                    statusClass = 'mobile-status-critical';
                } else if (qty >= 10 && qty <= 50) {
                    cardClass = 'medium-qty';
                    statusBadge = 'LOW STOCK';
                    statusClass = 'mobile-status-warning';
                } else {
                    cardClass = 'high-qty';
                    statusBadge = 'NORMAL';
                    statusClass = 'mobile-status-normal';
                }

                return `
                    <div class="mobile-item ${cardClass}">
                        <div class="mobile-header">
                            <div class="mobile-item-title">${row[2] || 'Unknown Item'}</div>
                            <div class="mobile-item-id">ID: ${row[1] || '-'}</div>
                        </div>
                        
                        <div class="mobile-qty-container">
                            <div class="mobile-qty">${qty.toLocaleString()}</div>
                            <div class="mobile-status-badge ${statusClass}">${statusBadge}</div>
                        </div>
                        
                        <div class="mobile-field">
                            <span class="mobile-label">Location</span>
                            <span class="mobile-value" title="${row[0] || '-'}">${row[0] || '-'}</span>
                        </div>
                        <div class="mobile-field">
                            <span class="mobile-label">Pallet</span>
                            <span class="mobile-value" title="${row[3] || '-'}">${row[3] || '-'}</span>
                        </div>
                        <div class="mobile-field">
                            <span class="mobile-label">Pallet No</span>
                            <span class="mobile-value" title="${row[4] || '-'}">${row[4] || '-'}</span>
                        </div>
                        <div class="mobile-field">
                            <span class="mobile-label">Batch</span>
                            <span class="mobile-value" title="${row[8] || '-'}">${row[8] || '-'}</span>
                        </div>
                        <div class="mobile-field">
                            <span class="mobile-label">Container</span>
                            <span class="mobile-value" title="${row[9] || '-'}">${row[9] || '-'}</span>
                        </div>
                        <div class="mobile-field">
                            <span class="mobile-label">UOM</span>
                            <span class="mobile-value" title="${row[11] || '-'}">${row[11] || '-'}</span>
                        </div>
                        <div class="mobile-field">
                            <span class="mobile-label">Base Qty</span>
                            <span class="mobile-value" title="${baseQty.toLocaleString()} ${row[13] || ''}">${baseQty.toLocaleString()} ${row[13] || ''}</span>
                        </div>
                        <div class="mobile-field">
                            <span class="mobile-label">Trans Date</span>
                            <span class="mobile-value" title="${row[5] || '-'}">${row[5] || '-'}</span>
                        </div>
                        <div class="mobile-field">
                            <span class="mobile-label">Prod Date</span>
                            <span class="mobile-value" title="${row[6] || '-'}">${row[6] || '-'}</span>
                        </div>
                        <div class="mobile-field">
                            <span class="mobile-label">Exp Date</span>
                            <span class="mobile-value" title="${row[7] || '-'}">${row[7] || '-'}</span>
                        </div>
                    </div>
                `;
            }).join('');

            // Update mobile pagination
            updateMobilePagination();
        }

        function updatePagination() {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage + 1;
            const endIndex = Math.min(currentPage * itemsPerPage, filteredData.length);

            document.getElementById('showingStart').textContent = filteredData.length > 0 ? startIndex : 0;
            document.getElementById('showingEnd').textContent = endIndex;
            document.getElementById('totalRecords').textContent = filteredData.length;

            // Generate pagination buttons
            const paginationNav = document.getElementById('paginationNav');
            let paginationHTML = '';

            // Previous button
            paginationHTML += `
                <button onclick="previousPage()" ${currentPage === 1 ? 'disabled' : ''} 
                        class="pagination-corporate relative inline-flex items-center px-4 py-2 rounded-lg text-sm font-semibold ${currentPage === 1 ? 'cursor-not-allowed opacity-50' : ''}">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                    </svg>
                    Prev
                </button>
            `;

            // Page numbers
            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
            
            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }

            for (let i = startPage; i <= endPage; i++) {
                paginationHTML += `
                    <button onclick="goToPage(${i})" 
                            class="pagination-corporate relative inline-flex items-center px-4 py-2 rounded-lg text-sm font-semibold ${i === currentPage ? 'active' : ''}">
                        ${i}
                    </button>
                `;
            }

            // Next button
            paginationHTML += `
                <button onclick="nextPage()" ${currentPage === totalPages ? 'disabled' : ''} 
                        class="pagination-corporate relative inline-flex items-center px-4 py-2 rounded-lg text-sm font-semibold ${currentPage === totalPages ? 'cursor-not-allowed opacity-50' : ''}">
                    Next
                    <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </button>
            `;

            paginationNav.innerHTML = paginationHTML;
        }

        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                renderTable();
                updatePagination();
            }
        }

        function nextPage() {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            if (currentPage < totalPages) {
                currentPage++;
                renderTable();
                updatePagination();
            }
        }

        function goToPage(page) {
            currentPage = page;
            renderTable();
            updatePagination();
        }

        function updateMobilePagination() {
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            const mobilePagination = document.getElementById('mobilePagination');
            
            if (totalPages <= 1) {
                mobilePagination.innerHTML = '';
                return;
            }
            
            let paginationHTML = '';
            
            // Previous button
            paginationHTML += `
                <button onclick="previousPage()" ${currentPage === 1 ? 'disabled' : ''} 
                        class="mobile-page-btn ${currentPage === 1 ? '' : 'hover:bg-gray-50'}">
                    ‹ Prev
                </button>
            `;
            
            // Current page info
            paginationHTML += `
                <span class="mobile-page-info">
                    ${currentPage} / ${totalPages}
                </span>
            `;
            
            // Next button
            paginationHTML += `
                <button onclick="nextPage()" ${currentPage === totalPages ? 'disabled' : ''} 
                        class="mobile-page-btn ${currentPage === totalPages ? '' : 'hover:bg-gray-50'}">
                    Next ›
                </button>
            `;
            
            mobilePagination.innerHTML = paginationHTML;
        }

        function updateTimestamp() {
            const now = new Date();
            const timeString = now.toLocaleString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('lastUpdated').textContent = timeString;
        }

        function getTimeAgo(date) {
            const now = new Date();
            const diffInSeconds = Math.floor((now - date) / 1000);
            
            if (diffInSeconds < 60) {
                return `${diffInSeconds} seconds ago`;
            } else if (diffInSeconds < 3600) {
                const minutes = Math.floor(diffInSeconds / 60);
                return `${minutes} minute${minutes > 1 ? 's' : ''} ago`;
            } else if (diffInSeconds < 86400) {
                const hours = Math.floor(diffInSeconds / 3600);
                return `${hours} hour${hours > 1 ? 's' : ''} ago`;
            } else {
                const days = Math.floor(diffInSeconds / 86400);
                return `${days} day${days > 1 ? 's' : ''} ago`;
            }
        }

        // Auto-refresh functionality
        let autoRefreshInterval;
        
        function startAutoRefresh() {
            // Check for updates every 30 seconds
            autoRefreshInterval = setInterval(async () => {
                try {
                    // Check if spreadsheet was modified
                    const driveUrl = `https://www.googleapis.com/drive/v3/files/${SPREADSHEET_ID}?key=${API_KEY}&fields=modifiedTime`;
                    const response = await fetch(driveUrl);
                    if (response.ok) {
                        const data = await response.json();
                        const lastModified = new Date(data.modifiedTime);
                        
                        // Update time ago display
                        const lastModifiedElement = document.getElementById('lastUpdated');
                        if (lastModifiedElement && lastModified) {
                            const timeAgo = getTimeAgo(lastModified);
                            const currentText = lastModifiedElement.innerHTML;
                            if (currentText.includes('font-bold')) {
                                // Update only the time ago part
                                lastModifiedElement.innerHTML = currentText.replace(/\(.*?\)/, `(${timeAgo})`);
                            }
                        }
                        
                        // Update mobile time ago display
                        const mobileLastUpdated = document.getElementById('mobileLastUpdated');
                        if (mobileLastUpdated && lastModified) {
                            const timeAgo = getTimeAgo(lastModified);
                            const currentText = mobileLastUpdated.textContent;
                            if (currentText.includes('(')) {
                                // Update only the time ago part
                                mobileLastUpdated.textContent = currentText.replace(/\(.*?\)/, `(${timeAgo})`);
                            }
                        }
                        
                        // Update system status
                        const minutesAgo = (new Date() - lastModified) / (1000 * 60);
                        const systemStatus = document.getElementById('systemStatus');
                        const statusIndicator = systemStatus.parentElement.querySelector('.animate-pulse');
                        
                        // Mobile status elements
                        const mobileStatusDot = document.getElementById('mobileStatusDot');
                        const mobileStatusText = document.getElementById('mobileStatusText');
                        
                        if (minutesAgo < 5) {
                            // Desktop status
                            systemStatus.textContent = 'LIVE';
                            systemStatus.className = 'text-2xl font-bold text-green-300 drop-shadow-lg';
                            statusIndicator.className = 'w-3 h-3 bg-green-400 rounded-full animate-pulse shadow-lg';
                            
                            // Mobile status
                            if (mobileStatusDot && mobileStatusText) {
                                mobileStatusDot.className = 'realtime-status-dot live';
                                mobileStatusText.textContent = 'LIVE';
                            }
                        } else if (minutesAgo < 30) {
                            // Desktop status
                            systemStatus.textContent = 'RECENT';
                            systemStatus.className = 'text-2xl font-bold text-yellow-300 drop-shadow-lg';
                            statusIndicator.className = 'w-3 h-3 bg-yellow-400 rounded-full animate-pulse shadow-lg';
                            
                            // Mobile status
                            if (mobileStatusDot && mobileStatusText) {
                                mobileStatusDot.className = 'realtime-status-dot recent';
                                mobileStatusText.textContent = 'RECENT';
                            }
                        } else {
                            // Desktop status
                            systemStatus.textContent = 'STALE';
                            systemStatus.className = 'text-2xl font-bold text-orange-300 drop-shadow-lg';
                            statusIndicator.className = 'w-3 h-3 bg-orange-400 rounded-full animate-pulse shadow-lg';
                            
                            // Mobile status
                            if (mobileStatusDot && mobileStatusText) {
                                mobileStatusDot.className = 'realtime-status-dot stale';
                                mobileStatusText.textContent = 'STALE';
                            }
                        }
                    }
                } catch (error) {
                    console.log('Auto-refresh check failed:', error);
                }
            }, 30000); // 30 seconds
        }

        function stopAutoRefresh() {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
                autoRefreshInterval = null;
            }
        }

        function refreshData() {
            const refreshBtn = document.getElementById('refreshBtn');
            const systemStatus = document.getElementById('systemStatus');
            
            // Update button state
            refreshBtn.disabled = true;
            refreshBtn.innerHTML = `
                <!-- Background Animation -->
                <div class="absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 -translate-x-full group-hover:translate-x-full transition-transform duration-700"></div>
                
                <!-- Loading Content -->
                <div class="relative flex items-center space-x-3">
                    <div class="p-2 bg-white/20 rounded-lg backdrop-blur-sm">
                        <svg class="w-5 h-5 animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                        </svg>
                    </div>
                    <div class="flex flex-col items-start">
                        <span class="text-white font-black text-base">Refreshing...</span>
                        <span class="text-white/70 text-xs font-medium">Loading data</span>
                    </div>
                </div>
                
                <!-- Status Indicator -->
                <div class="absolute top-2 right-2">
                    <div class="w-2 h-2 bg-yellow-400 rounded-full animate-pulse"></div>
                </div>
            `;
            
            // Update system status to show refreshing
            systemStatus.textContent = 'REFRESHING';
            systemStatus.className = 'text-2xl font-bold text-yellow-300 drop-shadow-lg animate-pulse';
            
            loadData().then(() => {
                // Reset system status to online
                systemStatus.textContent = 'ONLINE';
                systemStatus.className = 'text-2xl font-bold text-white drop-shadow-lg';
                
                // Reset button state
                refreshBtn.disabled = false;
                refreshBtn.innerHTML = `
                    <!-- Background Animation -->
                    <div class="absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 -translate-x-full group-hover:translate-x-full transition-transform duration-700"></div>
                    
                    <!-- Content -->
                    <div class="relative flex items-center space-x-3">
                        <div class="p-2 bg-white/20 rounded-lg backdrop-blur-sm group-hover:bg-white/30 transition-colors">
                            <svg class="w-5 h-5 transition-transform duration-300 group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                            </svg>
                        </div>
                        <div class="flex flex-col items-start">
                            <span class="text-white font-black text-base">Refresh Data</span>
                            <span class="text-white/70 text-xs font-medium">Update inventory</span>
                        </div>
                    </div>
                    
                    <!-- Status Indicator -->
                    <div class="absolute top-2 right-2">
                        <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                    </div>
                `;
            }).catch(() => {
                // Set system status to error
                systemStatus.textContent = 'ERROR';
                systemStatus.className = 'text-2xl font-bold text-red-300 drop-shadow-lg';
                
                // Reset button state with error
                refreshBtn.disabled = false;
                refreshBtn.innerHTML = `
                    <!-- Background Animation -->
                    <div class="absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 -translate-x-full group-hover:translate-x-full transition-transform duration-700"></div>
                    
                    <!-- Content -->
                    <div class="relative flex items-center space-x-3">
                        <div class="p-2 bg-white/20 rounded-lg backdrop-blur-sm group-hover:bg-white/30 transition-colors">
                            <svg class="w-5 h-5 transition-transform duration-300 group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                            </svg>
                        </div>
                        <div class="flex flex-col items-start">
                            <span class="text-white font-black text-base">Refresh Data</span>
                            <span class="text-white/70 text-xs font-medium">Update inventory</span>
                        </div>
                    </div>
                    
                    <!-- Status Indicator -->
                    <div class="absolute top-2 right-2">
                        <div class="w-2 h-2 bg-red-400 rounded-full animate-pulse"></div>
                    </div>
                `;
            });
        }



        function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('l', 'mm', 'a4'); // landscape orientation
            
            doc.setFontSize(16);
            doc.text('Inventory Monitoring Report', 14, 15);
            doc.setFontSize(10);
            doc.text(`Generated on: ${new Date().toLocaleString()}`, 14, 25);
            
            const headers = [['Location ID', 'Item ID', 'Item Name', 'Pallet', 'Pallet No', 'Trans Date', 'Prod Date', 'Exp Date', 'Batch', 'Container', 'Qty', 'UOM', 'Base Qty', 'Base UOM']];
            
            const data = filteredData.map(row => [
                row[0] || '', row[1] || '', row[2] || '', row[3] || '', row[4] || '',
                row[5] || '', row[6] || '', row[7] || '', row[8] || '', row[9] || '',
                row[10] || '', row[11] || '', row[12] || '', row[13] || ''
            ]);
            
            doc.autoTable({
                head: headers,
                body: data,
                startY: 30,
                styles: { fontSize: 8 },
                headStyles: { fillColor: [66, 139, 202] },
                didDrawCell: function(data) {
                    // Highlight rows based on Qty
                    if (data.column.index === 10 && data.section === 'body') {
                        const qty = parseFloat(data.cell.text[0]) || 0;
                        if (qty < 10) {
                            data.cell.styles.fillColor = [252, 228, 236]; // Light red
                        } else if (qty >= 10 && qty <= 50) {
                            data.cell.styles.fillColor = [255, 249, 196]; // Light yellow
                        }
                    }
                }
            });
            
            doc.save(`inventory_report_${new Date().toISOString().split('T')[0]}.pdf`);
        }

        function toggleTopItems() {
            const content = document.getElementById('topItemsContent');
            const icon = document.getElementById('topItemsToggleIcon');
            
            if (content.classList.contains('hidden')) {
                // Show content
                content.classList.remove('hidden');
                content.classList.add('animate-fadeIn');
                icon.style.transform = 'rotate(180deg)';
            } else {
                // Hide content
                content.classList.add('hidden');
                content.classList.remove('animate-fadeIn');
                icon.style.transform = 'rotate(0deg)';
            }
        }

        function exportToExcel() {
            // Create workbook and worksheet
            const wb = XLSX.utils.book_new();
            
            // Prepare headers
            const headers = [
                'Location ID', 'Item ID', 'Item Name', 'Pallet', 'Pallet No', 
                'Transaction Date', 'Production Date', 'Expiry Date', 'Batch', 
                'Container ID', 'Quantity', 'UOM', 'Base Qty', 'Base UOM'
            ];
            
            // Prepare data with headers
            const wsData = [headers];
            
            // Add filtered data
            filteredData.forEach(row => {
                wsData.push([
                    row[0] || '', row[1] || '', row[2] || '', row[3] || '', row[4] || '',
                    row[5] || '', row[6] || '', row[7] || '', row[8] || '', row[9] || '',
                    parseFloat(row[10]) || 0, row[11] || '', parseFloat(row[12]) || 0, row[13] || ''
                ]);
            });
            
            // Create worksheet
            const ws = XLSX.utils.aoa_to_sheet(wsData);
            
            // Set column widths
            const colWidths = [
                { wch: 12 }, // Location ID
                { wch: 15 }, // Item ID
                { wch: 25 }, // Item Name
                { wch: 12 }, // Pallet
                { wch: 12 }, // Pallet No
                { wch: 15 }, // Transaction Date
                { wch: 15 }, // Production Date
                { wch: 15 }, // Expiry Date
                { wch: 15 }, // Batch
                { wch: 15 }, // Container ID
                { wch: 12 }, // Quantity
                { wch: 8 },  // UOM
                { wch: 12 }, // Base Qty
                { wch: 10 }  // Base UOM
            ];
            ws['!cols'] = colWidths;
            
            // Style the header row
            const headerStyle = {
                font: { bold: true, color: { rgb: "FFFFFF" } },
                fill: { fgColor: { rgb: "4472C4" } },
                alignment: { horizontal: "center", vertical: "center" }
            };
            
            // Apply header styling
            for (let col = 0; col < headers.length; col++) {
                const cellRef = XLSX.utils.encode_cell({ r: 0, c: col });
                if (!ws[cellRef]) ws[cellRef] = {};
                ws[cellRef].s = headerStyle;
            }
            
            // Apply conditional formatting for quantity column (column K, index 10)
            for (let row = 1; row < wsData.length; row++) {
                const qty = parseFloat(wsData[row][10]) || 0;
                const cellRef = XLSX.utils.encode_cell({ r: row, c: 10 });
                
                if (!ws[cellRef]) ws[cellRef] = {};
                
                if (qty < 10) {
                    // Critical - Red background
                    ws[cellRef].s = {
                        fill: { fgColor: { rgb: "FFCDD2" } },
                        font: { bold: true, color: { rgb: "C62828" } }
                    };
                } else if (qty >= 10 && qty <= 50) {
                    // Warning - Yellow background
                    ws[cellRef].s = {
                        fill: { fgColor: { rgb: "FFF9C4" } },
                        font: { bold: true, color: { rgb: "F57F17" } }
                    };
                } else {
                    // Normal - Green background
                    ws[cellRef].s = {
                        fill: { fgColor: { rgb: "C8E6C9" } },
                        font: { bold: true, color: { rgb: "2E7D32" } }
                    };
                }
            }
            
            // Add summary sheet
            const summaryData = [
                ['INVENTORY SUMMARY REPORT'],
                ['Generated on:', new Date().toLocaleString()],
                [''],
                ['METRICS', 'VALUE'],
                ['Total Records', filteredData.length],
                ['Total Inventory Quantity', filteredData.reduce((sum, row) => sum + (parseFloat(row[10]) || 0), 0)],
                ['Total Base Quantity', filteredData.reduce((sum, row) => sum + (parseFloat(row[12]) || 0), 0)],
                ['Unique Items', new Set(filteredData.map(row => row[1])).size],
                ['Low Stock Items (< 10)', filteredData.filter(row => (parseFloat(row[10]) || 0) < 10).length],
                ['Medium Stock Items (10-50)', filteredData.filter(row => {
                    const qty = parseFloat(row[10]) || 0;
                    return qty >= 10 && qty <= 50;
                }).length],
                ['High Stock Items (> 50)', filteredData.filter(row => (parseFloat(row[10]) || 0) > 50).length]
            ];
            
            const summaryWs = XLSX.utils.aoa_to_sheet(summaryData);
            
            // Style summary sheet
            summaryWs['!cols'] = [{ wch: 25 }, { wch: 20 }];
            
            // Style title
            if (summaryWs['A1']) {
                summaryWs['A1'].s = {
                    font: { bold: true, size: 16, color: { rgb: "1565C0" } },
                    alignment: { horizontal: "center" }
                };
            }
            
            // Style headers
            if (summaryWs['A4']) {
                summaryWs['A4'].s = headerStyle;
            }
            if (summaryWs['B4']) {
                summaryWs['B4'].s = headerStyle;
            }
            
            // Add worksheets to workbook
            XLSX.utils.book_append_sheet(wb, summaryWs, "Summary");
            XLSX.utils.book_append_sheet(wb, ws, "Inventory Data");
            
            // Generate filename with timestamp
            const timestamp = new Date().toISOString().split('T')[0];
            const filename = `InventoryPro_Report_${timestamp}.xlsx`;
            
            // Save file
            XLSX.writeFile(wb, filename);
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9839cfdef4c52a90',t:'MTc1ODYyODA5Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
